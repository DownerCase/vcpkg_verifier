From ce93124b5e459faaa76c5d8902183a24239bd2bc Mon Sep 17 00:00:00 2001
From: DownerCase <downercase8@gmail.com>
Date: Sat, 8 Jul 2023 13:36:23 +0100
Subject: [PATCH] fix dependencies

---
 contrib/ecalhdf5/CMakeLists.txt | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/contrib/ecalhdf5/CMakeLists.txt b/contrib/ecalhdf5/CMakeLists.txt
index c167bacd4..45e754340 100644
--- a/contrib/ecalhdf5/CMakeLists.txt
+++ b/contrib/ecalhdf5/CMakeLists.txt
@@ -18,9 +18,14 @@
 
 project(hdf5 LANGUAGES C CXX)
 
-if(NOT CMAKE_CROSSCOMPILING)
+if(1)
   find_package(HDF5 COMPONENTS C REQUIRED)
   find_package(Threads REQUIRED)
+  if (TARGET hdf5::hdf5-shared)
+    set(ECAL_LINK_HDF5_SHARED 1)
+  else()
+    set(ECAL_LINK_HDF5_SHARED 0)
+  endif()
 else()
   find_library(hdf5_path NAMES hdf5 REQUIRED PATH_SUFFIXES hdf5/serial)
   find_path(hdf5_include NAMES hdf5.h PATH_SUFFIXES hdf5/serial REQUIRED)  
-- 
2.41.0.windows.3

